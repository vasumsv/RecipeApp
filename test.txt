@Test
void getMettedRows_ExceptionInPaymentMode() {
    // Setup test data
    InvoicePayableModelForPayment payment = new InvoicePayableModelForPayment();
    payment.setProviderId("123"); // Will trigger the exception
    payment.setInvoiceType("APPROVED");
    payment.setEntity("ENTITY1");
    payment.setCurrency("USD");
    // Set other required fields...

    // Mock ONLY the interaction we're testing
    when(referentialServiceApi.getPaymentModeAndSettlementLocation(
        new BigInteger("123"), // Must match providerId
        any(BigInteger.class),
        any(BigInteger.class),
        anyString(),
        anyString()
    )).thenThrow(new RuntimeException("Mocked exception"));

    // Execute
    List<PaymentLinesModel> result = cashAllocationDomain.getMettedRows(
        Collections.singletonList(payment), 
        "user1"
    );

    // Verify
    assertNotNull(result.get(0).getComment());
    verify(referentialServiceApi, times(1))
        .getPaymentModeAndSettlementLocation(any(), any(), any(), any(), any());
}