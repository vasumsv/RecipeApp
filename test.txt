@Test
void getMettedPaymentRows_PaymentModeException() {
    // 1. Create payment with NUMERIC providerId
    InvoicePayableModelForPayment payment = createBasePayment();
    payment.setProviderId("123456"); // Must be numeric
    payment.setAmount(new BigDecimal("1000.00"));
    List<InvoicePayableModelForPayment> payments = Collections.singletonList(payment);

    // 2. Mock with numeric providerId
    when(referentialServiceApi.getPaymentModeAndSettlementLocation(
        eq(new BigInteger("123456")), // Now valid
        any(BigInteger.class), 
        any(BigInteger.class), 
        eq("S"), 
        eq("USD")
    )).thenThrow(new RuntimeException("Payment Mode Error"));

    // 3. Execute
    List<PaymentLinesModel> result = cashAllocationDomain.getMettedPaymentRowsForManualPayment(
        payments, 
        "user1"
    );

    // 4. Verify
    assertFalse(result.isEmpty());
    assertTrue(result.get(0).getComment().contains("Payment Mode unavailable"));
}