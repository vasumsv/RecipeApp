@Then("I should receive a successful invoice response")
public void verifySuccessResponse() throws IOException {
    // 1. First, verify the response is valid
    assertNotNull("Response entity is null", responseEntity);
    assertNotNull("Response body is null", responseEntity.getBody());
    
    // 2. Set up the temp directory (ADD THIS PART)
    private static final String TEMP_DIR = "target/temp/";
    Path tempDirPath = Paths.get(TEMP_DIR);
    if (!Files.exists(tempDirPath)) {
        Files.createDirectories(tempDirPath);
    }
    
    // 3. Save the invoice to a file
    String fileName = "temp_invoice_" + responseEntity.getBody().getInvoiceReference() + ".json";
    Path filePath = Paths.get(TEMP_DIR + fileName);
    
    ObjectMapper mapper = new ObjectMapper();
    mapper.writeValue(filePath.toFile(), responseEntity.getBody());
    this.tempInvoiceFilePath = filePath.toString();
    
    logger.info("Saved temporary invoice file: {}", tempInvoiceFilePath);
}